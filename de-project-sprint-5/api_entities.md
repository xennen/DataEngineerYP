# Витрина для расчетов с курьерами

## Список полей витрины.

- **id** — идентификатор записи.
- **courier_id** — ID курьера, которому перечисляем.
- **courier_name** — Ф. И. О. курьера.
- **settlement_year** — год отчёта.
- **settlement_month** — месяц отчёта, где 1 — январь и 12 — декабрь.
- **orders_count** — количество заказов за период (месяц).
- **orders_total_sum** — общая стоимость заказов.
- **rate_avg** — средний рейтинг курьера по оценкам пользователей.
- **order_processing_fee** — сумма, удержанная компанией за обработку заказов, которая высчитывается как orders_total_sum * 0.25.
- **courier_order_sum** — сумма, которую необходимо перечислить курьеру за доставленные им/ей заказы. За каждый доставленный заказ курьер должен получить некоторую сумму в зависимости от рейтинга (см. ниже).
- **courier_tips_sum** — сумма, которую пользователи оставили курьеру в качестве чаевых.
- **courier_reward_sum** — сумма, которую необходимо перечислить курьеру. Вычисляется как courier_order_sum + courier_tips_sum * 0.95 (5% — комиссия за обработку платежа).

## Таблицы в слое DDS.

### Существующие таблицы:

- **dm_orders** - измерение с информацией по заказу.
- **dm_timestamps** - измерение по дате заказа.

### Новые таблицы:

- **dm_couriers** - измерение с информацией о курьере.
- **fct_deliveries** - факты доставок.

## Поля из API.

### couriers

- **id** - уникальный идентификатор записи;
- **_id** — ID курьера в БД;
- **name** — имя курьера.

### deliveries

- **id** - уникальный идентификатор записи;
- **order_id** — ID заказа;
- **order_ts** — дата и время создания заказа;
- **delivery_id** — ID доставки;
- **courier_id** —  ID курьера;
- **address** — адрес доставки;
- **delivery_ts** — дата и время совершения доставки;
- **rate** — рейтинг доставки, который выставляет покупатель: целочисленное значение от 1 до 5;
- **sum** — сумма заказа (в руб.);
- **tip_sum** — сумма чаевых, которые оставил покупатель курьеру (в руб.).